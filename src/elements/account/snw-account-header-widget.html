<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../helpers/snw-jwt-helper.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="snw-login.html">
<link rel="import" href="snw-logout.html">
<link rel="import" href="../helpers/snw-ls.html">
<link rel="import" href="../../styles/dark-theme/dark-theme.html">

<dom-module id="snw-account-header-widget">
  <template>
    <style include="dark-theme"></style>
    <snw-jwt-helper id="jwtHelper"></snw-jwt-helper>
    <snw-ls id="ls" on-ls-change="handleLsChange"></snw-ls>

    <paper-button hidden="{{!_isLoggedIn}}">Account</paper-button>
    <snw-logout on-logout="handleLogout" hidden="{{!_isLoggedIn}}"></snw-logout>
    <snw-login on-login="handleLogin" hidden="{{_isLoggedIn}}"></snw-login>
  </template>

  <script>
    (function(){
      'use strict';
      Polymer({
        is: 'snw-account-header-widget',
        properties:{
          _isLoggedIn: {
            type: Boolean,
            notify: true,
            value: false
          }
        },

        handleLsChange: function(e){
          if(e.detail.type === 'jwt'){
            this._isLoggedIn = (e.detail.e.length > 0);
          }
        },

        handleLogin: function(){
          this._isLoggedIn = true;
        },
        
        handleLogout: function(){
          this._isLoggedIn = false;
        }
      });
    })();
  </script>
</dom-module>