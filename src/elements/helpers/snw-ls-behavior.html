<link rel="import" href="../../bower_components/app-storage/app-storage-behavior.html">

<script>
  window.SNW = window.SNW || {};

  SNW.LsBehavior = {
    behaviors: [
        Polymer.AppStorageBehavior
    ],

    saveToLs: function(key, value, isSession){
      if(!key || !value) return;

      var storage = this.__computeStorage(isSession || false);
      storage.setItem(key, JSON.stringify(value || {}));

      this.fire('ls-change', value);
    },

    loadFromLs: function(key, isSession){
      if(!key) return;

      var storage = this.__computeStorage(isSession || false);
      try {
        return JSON.parse(storage.getItem(key));
      } catch(e) {
        console.error('Failed to parse value from storage for', this.key);
      }
    },

    deleteFromLs: function(key, isSession){
      if(!key) return;

      var storage = this.__computeStorage(isSession || false);
      storage.removeItem(key);
    },

    __computeStorage: function(sessionOnly) {
      return sessionOnly ? window.sessionStorage : window.localStorage;
    }
  }
</script>